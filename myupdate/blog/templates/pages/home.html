{% extends "base.html" %}
{% block title %}Update{% endblock %}

{% block content %}

<!--Section: Content-->

<section class="mb-5">
    <div class="row mb-4">
            {% for p in list %}
            <div class="card mb-5">
                <div class="card-body">
                    <div class="d-flex">
                        <i class="fas fa-user-circle fa-2x"></i>
                        <div class="d-blox ms-2">
                            <h5 class="card-title"><a href="{% url 'post:detail' p.slug %}">{{p.title}}</a></h5>
                            <h6 class="card-subtitle mb-2 text-muted" style="font-size: 0.7rem !important">
                                {{p.created_at|date:settings.DATETIME_FORMAT}}</h6>
                        </div>
                    </div>


                </div>
                <div class="bg-image hover-overlay ripple" data-mdb-ripple-color="light">
                    <img
                            src="media/{{p.icon}}"
                            class="img-fluid"
                            style="height: 250px;width:100%"
                    />

                </div>
                <div class="card-body">
                    <p class="card-text mt-3">
                        {{p.summary}}
                    </p>

                    <div class="d-flex justify-content-between">
                        <div></div>
                        <button type="button" class="btn btn-light btn-floating"
                                data-mdb-toggle="collapse"
                                data-mdb-target="#collapseExample{{p.id}}"
                                aria-expanded="false"
                                aria-controls="collapseExample{{p.id}}"
                                onclick="read_post({{p.id}});"
                                id="list-post-{{p.id}}"
                        >
                            <i id="read-post-{{p.id}}" class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                    <div class="collapse mt-3" id="collapseExample{{p.id}}">
                        {{p.content|safe|escape}}
                    </div>
                </div>
            </div>
            {% endfor %}
            {% if list|length > 0 %}
           <div class="d-flex justify-content-center">
                           <div class="pagination">
                <span class="step-links">
                    {% if list.has_previous %}
                        <a href="?page=1" class="btn btn-link btn-sm" data-mdb-ripple-color="dark">&laquo; first</a>
                        <a href="?page={{ list.previous_page_number }}" class="btn btn-link btn-sm" data-mdb-ripple-color="dark">previous</a>
                    {% endif %}

                    <span class="current">
                        Trang {{ list.number }} of {{ list.paginator.num_pages }}. {{list.has_other_pages}}
                    </span>

                    {% if list.has_next %}
                        <a href="?page={{ list.next_page_number }}" class="btn btn-link btn-sm">next</a>
                        <a href="?page={{ list.paginator.num_pages }}" class="btn btn-link btn-sm">last &raquo;</a>
                    {% endif %}
                </span>
            </div>

           </div>

            {% endif %}
    </div>
</section>


<script>
        function read_post(id){
        var expand = document.getElementById('list-post-'+id).getAttribute('aria-expanded');
        if(expand=='true'){
             $.ajax({
                type: "POST",
                url: '{{ 'read-post/' }}',
                data: { csrfmiddlewaretoken: '{{ csrf_token }}', id: id },
                success: function callback(response){
                document.getElementById("read-post-"+id).className = "fas fa-chevron-up";
                 }
            });
        }else{
        document.getElementById("read-post-"+id).className = "fas fa-chevron-down";
        }

        }


window.addEventListener('scroll',()=>{
    if(window.scrollY + window.innerHeight >=
    document.documentElement.scrollHeight){

        console.log('gooo')
    }
})

</script>
{% endblock %}

